<!DOCTYPE html>
{% load static %}

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Virtue</title>

    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
    crossorigin="anonymous"></script>

    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/semantic.min.css' %}">

    <script type="text/javascript" src="{% static 'js/semantic.min.js' %}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/2.0.2/anime.min.js"></script>
</head>
<body>
    <div id='main-screen' hidden>
        <div id="video-box" style="
            grid-template-columns: repeat(1, 1fr);">
            <div id="inner">
                <video id="local-video" class="video-style" height="480px" width="780px" autoplay playsinline></video>
                <canvas hidden id="blur-canvas"></canvas>
            </div>
        </div>
        <div class="video-buttons">
            <div>
                <button id = "toggle-audio-button" class="circular ui icon button">Mute</button>
                <button id = "toggle-video-button" class="circular ui icon button">Video off</button>
                <a href="/video"><button id = "disconnect-button" class="circular ui icon button btn-danger">Disconnect</button></a>
                <button id = "btn-share-screen" class="circular ui icon button">Share Screen</button>
                <button type="button" id = "multiple-cameras-button" class="circular ui icon button">God's eye</button>
                <button id = "toggle-blur-mode" class="circular ui icon button">Blur Video</button>
                <button id = "invite-button" class="circular ui icon button">Invite</button>
            </div>
        </div>
        <button class="openbtn circular ui icon button" onclick="openNav()">Chat</button>
        <div id = "chat" class='sidepanel'>
            <h3>Chat Messages</h3>
            <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
            
            <div id = "messages">
                <ul id = "message-list"></ul>
            </div>
            
            <div class='field send-message'>
                <input id = "message" maxlength="100"/><button id="send-msg-button"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right-circle-fill" viewBox="0 0 16 16">
                    <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0zM4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"/>
                  </svg></button>
            </div>
        </div>
    </div>
    <div id="ml4">
        <h1 class="ml4">
            <span class="letters letters-1">Ready</span>
            <span class="letters letters-2">Set</span>
            <span class="letters letters-3">Go!</span>
        </h1>
    </div>
    <section class="blur-background" hidden>
        <h1 class="ml13 gods-eye" style="text-align: center;" hidden>God's eye on</h1>
        <h1 class="ml13 blur-mode" style="text-align: center;" hidden>Blur mode on</h1>
        <p hidden>Virtue will automatically detect the camera you are looking into and will send your stream from it.</p>
    </section>
    <div id="myModal" class="modal">

        <!-- Modal content -->
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h2 class="modal-title">Invite people</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <form class="ui form success" id='invitation-form'>
                    {% csrf_token %}
                    <div class="field">
                        <label>Email</label>
                        <input type="email" id='email' name = "email" placeholder="Email">
                    </div>
                    <div class="ui success message" hidden>
                        <div class="header">Invitation Sent!</div>
                        <p>We have sent the invitation on this email. You can expect the guests anytime.</p>
                    </div>
                    <button class="ui submit button">Invite</button>
                </form>
            </div>
        </div>
      </div>
    <!-- Require the peer dependencies of face-landmarks-detection. -->
    <script src="https://unpkg.com/@tensorflow/tfjs-core@2.4.0/dist/tf-core.js"></script>
    <script src="https://unpkg.com/@tensorflow/tfjs-converter@2.4.0/dist/tf-converter.js"></script>

    <!-- You must explicitly require a TF.js backend if you're not using the tfjs union bundle. -->
    <script src="https://unpkg.com/@tensorflow/tfjs-backend-webgl@2.4.0/dist/tf-backend-webgl.js"></script>
    <!-- Alternatively you can use the WASM backend: <script src="https://unpkg.com/@tensorflow/tfjs-backend-wasm@2.4.0/dist/tf-backend-wasm.js"></script> -->

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/body-pix@2.0"></script>
    <!-- <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/body-pix@2.2.0/dist/body-pix.min.js"></script> -->

    <!-- Require face-landmarks-detection itself. -->
    <script src="https://unpkg.com/@tensorflow-models/face-landmarks-detection@0.0.1/dist/face-landmarks-detection.js"></script>
    {{ room|json_script:"roomname"}}
    <script type="text/javascript" src="{% static 'js/animation.js' %}"></script>
    {{ username|json_script:"passed"}}
    <script type="text/javascript" src="{% static 'js/connect.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/chat.js'%}"></script>
    <script type="text/javascript" src="{% static 'js/multipleCameras.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/blur.js' %}"></script>
    
</body>
</html>